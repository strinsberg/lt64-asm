(lt64-asm-prog
  (static
    (:word A 10 1 8 3 2 7 -2 6 3 4 0)
    (:word i 1 1))

  (main
    ;; Load A[0]
    :push A
    :load-lb

    ;; Loop over nums
    :label loop

    ;; Load num at A[i]
    :push i
    :load-lb
    :push A
    :add
    :load-lb

    ;; call max function
    :push max
    :call

    ;; Check if we have run them all
    :push i
    :load-lb
    :push 9
    :eq
    :push end-loop
    :branch
    
    ;; not finished increment i and loop
    :push i
    :push inc-at
    :call
    :push loop
    :jump

    ;; finished
    :label end-loop
    :wprn
    :push 10
    :prnch
    :halt)

  ;; Procedure to load an address on the stack increment and store it
  (proc inc-at
    :first
    :load-lb
    :push 1
    :add
    :swap
    :store-lb
    :ret)

  ;; Import the max procedure
  (include "test/lt64_asm/max_proc.lta")
)
